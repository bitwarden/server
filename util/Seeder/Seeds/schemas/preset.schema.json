{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "preset.schema.json",
  "title": "Bitwarden Seeder Preset",
  "description": "Defines a complete seeding preset that composes organization, users, groups, collections, and ciphers.",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "$schema": {
      "type": "string"
    },
    "organization": {
      "type": "object",
      "description": "Organization configuration. Use 'fixture' for a named fixture, or 'name'+'domain' for inline creation.",
      "additionalProperties": false,
      "properties": {
        "fixture": {
          "type": "string",
          "description": "Name of an organization fixture file (e.g., 'dunder-mifflin')."
        },
        "name": {
          "type": "string",
          "description": "Organization display name (used with inline creation)."
        },
        "domain": {
          "type": "string",
          "description": "Organization domain (used with inline creation and generator seeding)."
        },
        "seats": {
          "type": "integer",
          "minimum": 1,
          "default": 10,
          "description": "Number of seats in the organization."
        },
        "planType": {
          "type": "string",
          "enum": ["free", "teams-monthly", "teams-annually", "enterprise-monthly", "enterprise-annually", "teams-starter", "families-annually"],
          "description": "Billing plan type. Defaults to enterprise-annually if omitted."
        }
      }
    },
    "roster": {
      "type": "object",
      "description": "Named roster fixture for users, groups, and collections.",
      "additionalProperties": false,
      "properties": {
        "fixture": {
          "type": "string",
          "description": "Name of a roster fixture file (e.g., 'dunder-mifflin')."
        }
      },
      "required": ["fixture"]
    },
    "users": {
      "type": "object",
      "description": "Generate random users.",
      "additionalProperties": false,
      "properties": {
        "count": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of users to generate."
        },
        "realisticStatusMix": {
          "type": "boolean",
          "default": false,
          "description": "When true and count >= 10, creates realistic mix: 85% Confirmed, 5% Invited, 5% Accepted, 5% Revoked."
        }
      },
      "required": ["count"]
    },
    "groups": {
      "type": "object",
      "description": "Generate random groups with round-robin user assignment.",
      "additionalProperties": false,
      "properties": {
        "count": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of groups to generate."
        }
      },
      "required": ["count"]
    },
    "collections": {
      "type": "object",
      "description": "Generate random collections with user assignments.",
      "additionalProperties": false,
      "properties": {
        "count": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of collections to generate."
        }
      },
      "required": ["count"]
    },
    "folders": {
      "type": "boolean",
      "default": false,
      "description": "When true, generates folders for each user using a realistic distribution."
    },
    "ciphers": {
      "type": "object",
      "description": "Cipher configuration. Use 'fixture' for a named fixture, or 'count' for random generation.",
      "additionalProperties": false,
      "properties": {
        "fixture": {
          "type": "string",
          "description": "Name of a cipher fixture file (e.g., 'autofill-testing')."
        },
        "count": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of random ciphers to generate."
        },
        "assignFolders": {
          "type": "boolean",
          "default": false,
          "description": "When true, assigns generated ciphers to user folders round-robin. Requires 'folders' to be true."
        }
      }
    },
    "personalCiphers": {
      "type": "object",
      "description": "Generate personal ciphers for each user's personal vault.",
      "additionalProperties": false,
      "properties": {
        "countPerUser": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of personal ciphers to generate per user."
        }
      },
      "required": ["countPerUser"]
    },
    "policies": {
      "type": "object",
      "description": "Organization policy configuration.",
      "additionalProperties": false,
      "properties": {
        "enableAll": {
          "type": "boolean",
          "default": false,
          "description": "When true, enables all policy types."
        },
        "except": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Policy types to exclude when enableAll is true."
        },
        "enable": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Specific policy types to enable (alternative to enableAll)."
        }
      }
    },
    "sso": {
      "type": "object",
      "description": "Single Sign-On configuration for the organization.",
      "additionalProperties": false,
      "properties": {
        "identifier": {
          "type": "string",
          "description": "SSO organization identifier used in login flows."
        },
        "encryptionType": {
          "type": "string",
          "enum": ["masterPassword", "trustedDevices"],
          "description": "How member keys are protected. 'masterPassword' = standard SSO, 'trustedDevices' = TDE (no master password)."
        },
        "provider": {
          "type": "string",
          "enum": ["oidc", "saml"],
          "description": "Identity provider protocol."
        }
      }
    }
  }
}
